<!DOCTYPE html>
<html class="h-100" xmlns:th="http://www.thymeleaf.org">
  <head>
    <th:block th:replace="fragments/head :: header" />
    <title>Tournament Manager</title>
  </head>

  <body class="d-flex flex-column h-100 body">
    <!-- Reemplazo del header desde el archivo nav.html -->
    <header th:replace="fragments/nav.html :: nav"></header>

    <main class="flex-shrink-0 main">
      <div class="container">
        <h1 class="text-center page-title">ÚNETE A UN TORNEO</h1>
        <h2 class="mt-3 text-center">
          ¡Inscribe a tu equipo en el torneo que más te guste!
        </h2>
        <h3 class="text-center" th:if="${tournaments.isEmpty()}">No hay torneos actualmente.</h3>
      </div> 
      <div class="container">

        <ul class="tournament-list">
          <li th:each="tournament : ${tournaments}">
            <div class="tournament-info">

              <div th:classappend="${tournament.value.getNTeams()} == ${tournament.value.getMaxTeams()} ? tournament-full : tournament-status" 
              th:text="${tournament.value.getNTeams()} == ${tournament.value.getMaxTeams()} ? 'Tournament full' : 'Waiting for teams'"></div>
              
              <div class="tournament-slots">
                <span th:text="${tournament.value.getNTeams()}"></span>
                <!-- Acceder al primer valor del Pair -->
                <span>/</span>
                <span th:text="${tournament.value.getMaxTeams()}"></span>
                <!-- Acceder al segundo valor del Pair -->
              </div>

              <span
                th:if="${tournament.value.getNTeams() < tournament.value.getMaxTeams() && isUserCoach && !tournament.value.isMyTeamJoined()}"
              >
                <form method="post" th:action="@{/tournament/joinTournament}">
                  <input type="hidden" name="tournamentId" th:value="${tournament.key.id}" />
                  <input type="hidden" name="userId" th:value="${session.u.id}" />
                  <button class="btn btn-primary submit" type="submit">Join</button>
                </form>          
              </span>

              <div class="tournament-joined" th:if="${tournament.value.isMyTeamJoined()}">Your team is already in this tournament!</div>
            </div>
            <div class="tournament-name" th:text="${tournament.key.name}"></div>
          </li>
        </ul>
      </div>
    </main>

      <!-- Reemplazo del footer desde el archivo footer.html -->
      <th:block th:replace="fragments/footer.html :: footer" />
  </body>
</html>
